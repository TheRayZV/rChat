# rChat Плагин

Простой и настраиваемый плагин чата для Minecraft серверов.

## Возможности

- **Локальный чат**: Сообщения, отправленные без специального префикса, будут видны только игрокам в пределах настраиваемого радиуса
- **Глобальный чат**: Сообщения, начинающиеся с настраиваемого префикса (по умолчанию: `!`), будут видны всем игрокам
- **Настраиваемые форматы**: Установите разные форматы для сообщений в локальном и глобальном чате
- **Личные сообщения**: Отправляйте личные сообщения другим игрокам с помощью команды `/msg`
- **Оповещения**: Отправляйте оповещения на весь сервер, включая поддержку многострочных сообщений
- **Уведомления о пустом чате**: Уведомления для игроков, если их сообщение в локальном чате никто не видел
- **Настраиваемые сообщения**: Все сообщения плагина можно настроить в конфигурации
- **Система прав**: Контролируйте, кто может использовать локальный и глобальный чат, личные сообщения и оповещения
- **Поддержка цветов**: Игроки с соответствующими правами могут использовать цветовые коды в своих сообщениях
- **Интеграция с LuckPerms**: Поддержка плейсхолдеров для префиксов, суффиксов, групп и мета-данных
- **Кастомные сообщения о входе/выходе**: Настраиваемые сообщения о входе и выходе игроков
- **Кастомные сообщения о достижениях**: Настраиваемые сообщения о получении игроками достижений

## Особенности
- Настраиваемые форматы сообщений для локального и глобального чата
- Поддержка форматов сообщений в зависимости от мира
- Поддержка префиксов и суффиксов LuckPerms
- Система прав для управления доступом к различным функциям чата
- Личные сообщения с возможностью ответа
- Настраиваемые сообщения о входе и выходе игроков
- Настраиваемые сообщения о смерти игроков и убийствах
- Настраиваемые сообщения о достижениях
- Уведомления о сообщениях в пустой локальный чат
- Возможность контроля цветовых кодов в сообщениях игроков

## Команды

- `/rchat help` - Показать сообщение помощи
- `/rchat reload` - Перезагрузить конфигурацию плагина
- `/rchat set prefix <prefix>` - Установить префикс глобального чата
- `/rchat set radius <radius>` - Установить радиус локального чата
- `/rchat set format <global|local> <format>` - Установить формат чата
- `/rchat set join <format>` - Установить формат сообщения о входе
- `/rchat set quit <format>` - Установить формат сообщения о выходе
- `/rchat set achievements <format>` - Установить формат сообщения о достижениях
- `/rchat toggle <join|quit|achievements|private|broadcast|no_recipients>` - Включить/выключить определенную функцию
- `/msg <игрок> <сообщение>` - Отправить личное сообщение игроку (алиасы: `/tell`, `/w`, `/whisper`, `/m`, `/pm`)
- `/reply <сообщение>` или `/r <сообщение>` - Ответить на последнее полученное личное сообщение
- `/broadcast <сообщение>` - Отправить оповещение на весь сервер (алиасы: `/bc`, `/alert`, `/announce`)

## Система прав
- `rchat.reload` - Право на перезагрузку плагина
- `rchat.broadcast` - Право на отправку объявлений
- `rchat.global` - Право на использование глобального чата
- `rchat.local` - Право на использование локального чата
- `rchat.msg` - Право на отправку личных сообщений
- `rchat.msg.reply` - Право на ответ на личные сообщения
- `rchat.color` - Право на использование цветовых кодов в сообщениях
- `rchat.notify` - Право на получение уведомлений

## Конфигурация

```yaml
# Настройки чата
chat:
  # Настройки глобального чата
  global:
    # Префикс для глобальных сообщений (например, "!привет" отправит "привет" в глобальный чат)
    prefix: "!"
    # Формат для глобальных сообщений
    format: "&7[&cГлобальный&7] &f{player}&7: &f{message}"

  # Настройки локального чата
  local:
    # Радиус локального чата в блоках
    radius: 100
    # Формат для локальных сообщений
    format: "&7[&aЛокальный&7] &f{player}&7: &f{message}"

    # Уведомление, если никто не видел сообщение
    no_recipients:
      enabled: true
      message: "&7[&cУведомление&7] &fВаше сообщение никто не увидел. Рядом нет других игроков."

  # Настройки личных сообщений
  private:
    enabled: true
    sender_format: "&7[&dЯ &7→ &d{recipient}&7] &f{message}"
    recipient_format: "&7[&d{sender} &7→ &dЯ&7] &f{message}"
    show_success_message: false  # Отображать ли уведомление об успешной отправке сообщения

  # Настройки оповещений
  broadcast:
    enabled: true
    format-lines:
      - "&8[&c&lОБЪЯВЛЕНИЕ&8]"
      - "&f{message}"
    sound:
      enabled: true
      sound: "ENTITY_EXPERIENCE_ORB_PICKUP"
      volume: 1.0
      pitch: 1.0

# Настройки системных сообщений
system:
  # Настройки сообщений о входе игрока
  join:
    # Включить/выключить кастомные сообщения о входе
    enabled: true
    # Формат сообщения о входе
    # Доступные плейсхолдеры: {player}, {prefix}
    format: "&8[&a+&8] {prefix}&f{player} &7присоединился к серверу"
  
  # Настройки сообщений о выходе игрока
  quit:
    # Включить/выключить кастомные сообщения о выходе
    enabled: true
    # Формат сообщения о выходе
    # Доступные плейсхолдеры: {player}, {prefix}
    format: "&8[&c-&8] {prefix}&f{player} &7покинул сервер"
  
  # Настройки сообщений о смерти
  death:
    # Включить/выключить кастомные сообщения о смерти
    enabled: true
    # Формат сообщения при убийстве игроком
    # Доступные плейсхолдеры: {player}, {prefix}, {killer}, {killer_prefix}, {weapon}, {cause}
    killed_by_player_format: "&8[&4☠&8] {prefix}&f{player} &7был убит игроком &f{killer}"
    # Формат сообщения при смерти от других причин
    # Доступные плейсхолдеры: {player}, {prefix}, {cause}
    generic_format: "&8[&4☠&8] {prefix}&f{player} &7погиб {cause}"
  
  # Настройки сообщений о достижениях
  achievements:
    # Включить/выключить кастомные сообщения о достижениях
    enabled: true
    # Формат сообщения о достижении
    format: "&8[&e⭐&8] {prefix}&f{player} &eполучил достижение &6{achievement}"
    # Показывать описание достижения
    show_description: true
    # Формат описания
    description_format: "&7{description}"

# Настройки для разных миров (отдельные форматы для каждого мира)
worlds:
  world:
    # Формат локального чата для мира world
    # Доступные плейсхолдеры: {player}, {message}, {world}, {prefix}, {suffix}
    local_format: "&7[&aЛокальный &2{world}&7] &f{player}&7: &f{message}"
    # Формат глобального чата для мира world
    # Доступные плейсхолдеры: {player}, {message}, {world}, {prefix}, {suffix}
    global_format: "&7[&cГлобальный &4{world}&7] &f{player}&7: &f{message}"
  
  # Пример настройки для мира nether
  world_nether:
    local_format: "&7[&cАд &4{world}&7] &f{player}&7: &f{message}"
    global_format: "&7[&cАд &4{world}&7] &f{player} объявляет&7: &f{message}"

# Настройки для отображения названий миров
worlds:
  world: "ОБЫЧНЫЙ МИР"
  world_nether: "АД"
  world_the_end: "КРАЙ"
```

## Плейсхолдеры

В форматах чата можно использовать следующие плейсхолдеры:

### Общие плейсхолдеры
- `{player}` - Имя игрока
- `{message}` - Текст сообщения
- `{world}` - Название мира игрока
- `{prefix}` - Префикс игрока из LuckPerms
- `{suffix}` - Суффикс игрока из LuckPerms

### Плейсхолдеры для личных сообщений
- `{sender}` - Имя отправителя
- `{recipient}` - Имя получателя

### Плейсхолдеры для сообщений о смерти
- `{killer}` - Имя убийцы
- `{killer_prefix}` - Префикс убийцы из LuckPerms
- `{weapon}` - Название оружия убийства
- `{cause}` - Причина смерти
- `{killer_world}` - Название мира убийцы

### LuckPerms плейсхолдеры

- `{prefix}` - Префикс игрока из LuckPerms
- `{suffix}` - Суффикс игрока из LuckPerms
- `{group}` - Основная группа игрока
- `{lp_meta:ключ}` - Мета-данные игрока (например, `{lp_meta:rank}`)

Также поддерживается формат PlaceholderAPI:

- `%luckperms_prefix%` - Префикс игрока
- `%luckperms_suffix%` - Суффикс игрока
- `%luckperms_group%` или `%luckperms_primarygroup%` - Основная группа игрока
- `%luckperms_meta_ключ%` - Мета-данные игрока (например, `%luckperms_meta_rank%`)

Пример формата чата с LuckPerms плейсхолдерами:
```
"&7[&c{group}&7] {prefix}&f{player}{suffix}&7: &f{message}"
```

Или с использованием формата PlaceholderAPI:
```
"&7[&c%luckperms_group%&7] %luckperms_prefix%&f{player}%luckperms_suffix%&7: &f{message}"
```

## Установка

1. Скачайте JAR-файл плагина
2. Поместите его в папку `plugins` вашего сервера
3. Перезапустите сервер или загрузите плагин с помощью менеджера плагинов
4. Настройте плагин по необходимости

## Требования

- Java 21 или выше
- Paper/Spigot 1.21 или выше

## Зависимости

- **LuckPerms** - для плейсхолдеров префиксов, суффиксов, групп и мета-данных 

## Формат оповещений

Оповещения (broadcast) настраиваются как список строк в конфигурации:

```yaml
broadcast:
  enabled: true
  format-lines:
    - "&8[&c&lОБЪЯВЛЕНИЕ&8]"
    - "&f{message}"
```

Это позволяет создавать многострочные оповещения с заголовком и телом сообщения. Вы можете добавить столько строк, сколько необходимо. 
